(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8581:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return e(135)}])},135:function(n,t,e){"use strict";e.r(t),e.d(t,{default:function(){return w}});var r=e(4051),i=e.n(r),a=e(5893),o=e(9574);(0,o.vc)({"accessNode.api":"https://access-testnet.onflow.org","discovery.wallet":"https://fcl-discovery.onflow.org/testnet/authn","0xNFTDiary":"0x5e78e3e6351ae6c1"});var c=e(7294),l=e(6060),s=e(3519),u=e(3144),d=e(8695),h=e(8182),f=e(5005),y=e(3335),p=e(682),x=e(1608),m=e(1555),v=e(5530),b=e(3914),N=e(6986);function j(n,t,e,r,i,a,o){try{var c=n[a](o),l=c.value}catch(s){return void e(s)}c.done?t(l):Promise.resolve(l).then(r,i)}function g(n){return function(){var t=this,e=arguments;return new Promise((function(r,i){var a=n.apply(t,e);function o(n){j(a,r,i,o,c,"next",n)}function c(n){j(a,r,i,o,c,"throw",n)}o(void 0)}))}}function D(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function w(){var n={id:0,title:"",body:""},t=function(){var n=g(i().mark((function n(t){var e,r,a=arguments;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=a.length>1&&void 0!==a[1]?a[1]:[],n.next=3,o.lW([o._v(t),o.WC(e)]);case 3:return r=n.sent,n.next=6,o.Jx(r);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),e=function(){var n=g(i().mark((function n(t,e){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.lW([o.PS(t),o.WC(e),o.iB(o.ar().authorization),o.KX([o.ar().authorization]),o.$C(o.ar().authorization),o.b9(9999)]);case 2:return r=n.sent,n.abrupt("return",r);case 4:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}(),r=function(){var n=g(i().mark((function n(){var e;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=null===C||void 0===C?void 0:C.addr){n.next=3;break}return n.abrupt("return",[]);case 3:return n.next=5,t('import NFTDiary from 0xNFTDiary\n\npub fun main(addr: Address): [{String: String}] {\n    let metadataArray: [{String: String}] = []\n    let collectionCapability = getAccount(addr).getCapability<&{NFTDiary.NFTDiaryCollectionPublic}>(NFTDiary.CollectionPublicPath)\n    if !collectionCapability.check() {\n        return metadataArray\n    }\n    let collection = collectionCapability.borrow()!\n    let ids = collection.getIDs()\n    for id in ids {\n        let token = collection.borrowNFTDiary(id: id)\n        let metadata = token.metadata\n        metadata["id"] = token.id.toString()\n        metadataArray.append(metadata)\n    }\n    return metadataArray\n}\n',[o.R9(e,l.Address)]);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),j=function(){var n=g(i().mark((function n(t){var r,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.title,a=t.body,n.next=3,e('\nimport NFTDiary from 0xNFTDiary\n\ntransaction(metadata: {String: String}) {\n    prepare(acct: AuthAccount) {\n        // Setup Collection\n        if acct.borrow<&NFTDiary.Collection>(from: NFTDiary.CollectionStoragePath) == nil {\n            acct.save(<- NFTDiary.createEmptyCollection(), to: NFTDiary.CollectionStoragePath)\n            acct.link<&{NFTDiary.NFTDiaryCollectionPublic}>(NFTDiary.CollectionPublicPath, target: NFTDiary.CollectionStoragePath)\n        }\n\n        // Setup Minter\n        if acct.borrow<&NFTDiary.Minter>(from: NFTDiary.MinterStoragePath) == nil {\n            acct.save(<- NFTDiary.createMinter(), to: NFTDiary.MinterStoragePath)\n        }\n\n        // Mint and Deposit NFT\n        let minter = acct.borrow<&NFTDiary.Minter>(from: NFTDiary.MinterStoragePath)!\n        let receiverRef = acct.getCapability(NFTDiary.CollectionPublicPath).borrow<&{NFTDiary.NFTDiaryCollectionPublic}>()\n            ?? panic("Cannot borrow a reference to the recipient\'s Replica collection")\n        let token <- minter.mintNFT(metadata: metadata)\n        receiverRef.deposit(token: <- token)\n\n        log("Mint NFT succeeded")\n    }\n}\n',[o.R9([{key:"title",value:r},{key:"body",value:a},{key:"timestamp",value:Date.now().toString()},{key:"author",value:null===C||void 0===C?void 0:C.addr}],l.Dictionary({key:l.String,value:l.String}))]);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),w=function(){var n=g(i().mark((function n(t){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e('\nimport NFTDiary from 0xNFTDiary\n\ntransaction(tokenID: UInt64) {\n    prepare(acct: AuthAccount) {\n        let collection = acct.borrow<&NFTDiary.Collection>(from: NFTDiary.CollectionStoragePath)!\n        let token <- collection.withdraw(withdrawID: tokenID) as! @NFTDiary.NFT\n        destroy token\n\n        log("Delete NFT")\n    }\n}\n',[o.R9(Number(t),l.UInt64)]);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),T=(0,c.useState)({loggedIn:null}),C=T[0],Z=T[1];(0,c.useEffect)((function(){return o.ar.subscribe(Z)}),[]);var F=(0,c.useState)(!1),k=F[0],S=F[1],P=function(){return S(!1)},I=function(){return S(!0)},_=(0,c.useState)([]),A=_[0],O=_[1],M=function(){r().then((function(n){O(n)}))},E=(0,c.useState)(n),B=E[0],L=E[1],R=function(n){return function(t){var e=function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},r=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(e).filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})))),r.forEach((function(t){D(n,t,e[t])}))}return n}({},B,D({},n,t.target.value));L(e)}},W=function(){var n;return(0,a.jsxs)(s.Z,{title:null!==(n=null===C||void 0===C?void 0:C.addr)&&void 0!==n?n:"No Address",id:"basic-nav-dropdown",children:[(0,a.jsx)(s.Z.Item,{onClick:I,children:"Create New Diary"}),(0,a.jsx)(s.Z.Divider,{}),(0,a.jsx)(s.Z.Item,{onClick:o._b,children:"Log Out"})]})},z=function(){return(0,a.jsx)(u.Z.Link,{onClick:o.Ib,children:"Log In"})},H=function(n){var t=n.diaries.map((function(n){return(0,a.jsx)(d.Z.Item,{children:(0,a.jsxs)(h.Z,{children:[(0,a.jsxs)(h.Z.Body,{children:[(0,a.jsxs)(h.Z.Title,{children:["#",n.id,": ",n.title,(0,a.jsx)(u.Z,{className:"float-end",children:(0,a.jsx)(s.Z,{id:"diary-nav-dropdown",children:(0,a.jsx)(s.Z.Item,{onClick:(t=n.id,function(n){w(t).then((function(n){M()}))}),children:"Delete"})})})]}),(0,a.jsx)(h.Z.Text,{className:"ms-2",children:n.body})]}),(0,a.jsxs)(h.Z.Footer,{className:"text-muted",children:[n.timestamp?new Date(Number(n.timestamp)).toUTCString():""," By ",n.author?n.author:""]})]})},n.id.toString());var t}));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"my-3",children:"Your Diaries"}),(0,a.jsx)(f.Z,{className:"mb-3",variant:"outline-primary",onClick:M,children:"Get Diaries"}),(0,a.jsx)(d.Z,{children:t})]})};return(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Z,{bg:"light",expand:"lg",children:(0,a.jsxs)(p.Z,{children:[(0,a.jsx)(y.Z.Brand,{children:"NFT Diary"}),(0,a.jsx)(y.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,a.jsxs)(y.Z.Collapse,{id:"basic-navbar-nav",children:[(0,a.jsx)(u.Z,{className:"me-auto",children:(0,a.jsx)(u.Z.Link,{href:"#home",children:"Home"})}),(0,a.jsx)(u.Z,{className:"float-end",children:C.loggedIn?(0,a.jsx)(W,{}):(0,a.jsx)(z,{})})]})]})}),(0,a.jsx)(p.Z,{children:(0,a.jsx)(x.Z,{children:(0,a.jsx)(m.Z,{children:C.loggedIn?(0,a.jsx)(H,{diaries:A}):(0,a.jsx)("h1",{className:"my-3",children:"Please log in"})})})}),(0,a.jsxs)(v.Z,{show:k,onHide:P,children:[(0,a.jsx)(v.Z.Header,{closeButton:!0,children:(0,a.jsx)(v.Z.Title,{children:"Create New Diary"})}),(0,a.jsx)(v.Z.Body,{children:(0,a.jsxs)(b.Z,{children:[(0,a.jsxs)(N.Z,{controlId:"title",children:[(0,a.jsx)(b.Z.Label,{children:"Title"}),(0,a.jsx)(b.Z.Control,{type:"text",placeholder:"diary title",value:B.title,onChange:R("title")})]}),(0,a.jsxs)(N.Z,{controlId:"body",children:[(0,a.jsx)(b.Z.Label,{children:"Body"}),(0,a.jsx)(b.Z.Control,{as:"textarea",rows:5,value:B.body,onChange:R("body")})]})]})}),(0,a.jsxs)(v.Z.Footer,{children:[(0,a.jsx)(f.Z,{variant:"secondary",onClick:P,children:"Close"}),(0,a.jsx)(f.Z,{variant:"primary",onClick:function(){j(B).then((function(t){M(),L(n),P()}))},children:"Submit"})]})]})]})}}},function(n){n.O(0,[435,693,774,888,179],(function(){return t=8581,n(n.s=t);var t}));var t=n.O();_N_E=t}]);